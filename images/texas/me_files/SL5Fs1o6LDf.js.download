if (self.CavalryLogger) { CavalryLogger.start_js(["Afkbn"]); }

__d("StarsInput",["ArbiterMixin","DOM","Event","Parent","Run"],(function(a,b,c,d,e,f){__p&&__p();function c(a,c){this.root=a,this.hidden=c,this.stars=b("DOM").scry(a,"a"),this.listeners=[b("Event").listen(this.root,"click",this._onClick.bind(this))],b("Run").onLeave(this.destroyListeners.bind(this))}Object.assign(c.prototype,b("ArbiterMixin"),{_onClick:function(a){var b=this._getStarIndexFromEvent(a);if(!b)return;this.hidden.value=b;this.inform("stars/value_changed");a.prevent()},_getStarIndexFromEvent:function(a){a=b("Parent").byTag(a.getTarget(),"a");return a?this.stars.indexOf(a)+1:0},destroyListeners:function(){this.listeners.forEach(function(a){a&&a.remove()}),this.listeners=[]}});a.StarsInput=e.exports=c}),null);
__d("StarsRatableComposerCloseResetBehaviorEnum",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({NONE:"none",RESET_TO_EMPTY:"reset_to_empty",RESET_TO_PREVIOUS:"reset_to_previous"})}),null);
__d("StarsRatableBase",["Arbiter","CSS","DOM","Event","Parent","Run","StarsRatableComposerCloseResetBehaviorEnum"],(function(a,b,c,d,e,f){__p&&__p();function g(a,c,d,e){this.root=a,this.freezeOnClick=c,this.stars=b("DOM").scry(a,"a"),this.listeners=[b("Event").listen(this.root,"click",this._onClick.bind(this)),b("Event").listen(this.root,"mousemove",this._onMouseMove.bind(this)),b("Event").listen(this.root,"mouseout",this._onMouseOut.bind(this))],this.holdMouseMove=!1,this.setRating(d),this.defaultRating=d,this.composerHideResetBehavior=e,this.composerArbiters=[],b("Run").onLeave(this.destroyListeners.bind(this))}g.init=function(a,b,c,d){return new g(a,b,c,d)};Object.assign(g.prototype,{_onClick:function(a){__p&&__p();this.layerHides=0;var c=this._getStarIndexFromEvent(a);if(!c)return;this.setRating(c);this.freezeOnClick?this.freeze():this.holdMouseMove=!0;this.composerHideResetBehavior!==b("StarsRatableComposerCloseResetBehaviorEnum").NONE&&(this.composerArbiters=[b("Arbiter").subscribe("saving_rating_from_composer",function(a,c){this.defaultRating=c,this.setRating(this.composerHideResetBehavior===b("StarsRatableComposerCloseResetBehaviorEnum").RESET_TO_EMPTY?0:c),this._unsubscribeComposerArbiters()}.bind(this)),b("Arbiter").subscribe("canceling_from_composer",function(){this.setRating(this.composerHideResetBehavior===b("StarsRatableComposerCloseResetBehaviorEnum").RESET_TO_EMPTY?0:this.defaultRating),this._unsubscribeComposerArbiters()}.bind(this))]);a.prevent()},_unsubscribeComposerArbiters:function(){for(var a=0;a<this.composerArbiters.length;++a)b("Arbiter").unsubscribe(this.composerArbiters[a]);this.composerArbiters=[]},_onMouseMove:function(a){if(this.holdMouseMove)return;a=this._getStarIndexFromEvent(a);if(!a)return;this.setStars(a,!0)},_onMouseOut:function(a){this.holdMouseMove=!1,this.updateStars()},_getStarIndexFromEvent:function(a){a=b("Parent").byTag(a.getTarget(),"a");return a?this.stars.indexOf(a)+1:0},setRating:function(a){this._rating=a,this.updateStars()},updateStars:function(){this.setStars(this._rating)},setStars:function(a,c){var d=c?"hoverStar":"fullStar";c=c?"fullStar":"hoverStar";for(var e=0;e<this.stars.length;++e){b("CSS").removeClass(this.stars[e],c);var f=e>=a;b("CSS").conditionClass(this.stars[e],d,!f);b("CSS").conditionClass(this.stars[e],"emptyStar",f)}},freeze:function(){b("CSS").addClass(this.root,"uiStarsRated"),this.destroyListeners()},destroyListeners:function(){this.listeners.forEach(function(a){a&&a.remove()}),this.listeners=[]}});a.StarsRatableBase=e.exports=g}),null);
__d("GamesHubStarRating",["AsyncRequest"],(function(a,b,c,d,e,f){__p&&__p();var g=5e3;a=function(){"use strict";__p&&__p();function a(a,b){this.$1=b,this.$2=a,this.$1.subscribe("stars/value_changed",this.timedRequest.bind(this))}var c=a.prototype;c.timedRequest=function(){this.$3&&clearTimeout(this.$3),this.$3=setTimeout(this.sendRequest.bind(this),g)};c.sendRequest=function(){this.$3&&(clearTimeout(this.$3),this.$3=null);var a={app_id:this.$2,star_rating:this.$1.hidden.value};new(b("AsyncRequest"))("/games/async/app_rating").setMethod("POST").setData(a).send()};return a}();e.exports=a}),null);
__d("PageStars",["Event","Locale","Style"],(function(a,b,c,d,e,f){__p&&__p();var g=5;function a(a,c,d,e,f,g,h,i){__p&&__p();this.myRating=f;this.avgRating=e;this.avgStars=c;this.myStars=d;this.margin=i;this.width=g;this.height=h;for(var f=0;f<a.length;f++){e=a[f];c=f+1;for(var d=0;d<e.length;d++){if(!e[d])continue;b("Event").listen(e[d],"mouseenter",this._hover.bind(this,c));b("Event").listen(e[d],"mouseleave",this._mouseout.bind(this,c));b("Event").listen(e[d],"click",this._click.bind(this,c))}}}Object.assign(a.prototype,{onClick:function(a){this.callback=a},_updateUI:function(){this.hovered||this.myRating?(this.avgStars&&this._setClip(this.avgStars,0),this.myStars&&this._setClip(this.myStars,this.hovered||this.myRating)):(this.myStars&&this._setClip(this.myStars,0),this.avgStars&&this._setClip(this.avgStars,this.avgRating||0))},_setClip:function(a,c){var d=Math.round(c*this.width+Math.floor(c)*this.margin),e=0;b("Locale").isRTL()&&(e=Math.round((g-c)*this.width+Math.floor(g-c)*this.margin),d+=e);c="rect(0px, "+d+"px, "+this.height+"px, "+e+"px)";b("Style").set(a,"clip",c)},_click:function(a){this.myRating=a;this._updateUI();return this.callback&&this.callback(a)},_hover:function(a){this.hovered=a,this._updateUI()},_mouseout:function(a){this.hovered===a&&(this.hovered=null,this._updateUI())},setAverageRating:function(a){this.avgRating=a,this._updateUI()},setMyRating:function(a){this.myRating=a,this._updateUI()}});e.exports=a}),null);
__d("XReviewsTabUpdateHistogramController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/ajax/pages/review/update_histogram/",{page_id:{type:"Int"}})}),null);
__d("ReviewsController",["csx","fbt","ix","Arbiter","AsyncRequest","Dialog","DOM","Event","Image.react","React","ReactDOM","Run","XReviewsTabUpdateHistogramController","ge"],(function(a,b,c,d,e,f,g,h,i){__p&&__p();var j={},k={},l={},m={},n={};a={registerRevealProfanity:function(a,c,d){b("Event").listen(c,"click",function(){a.style.display="none",d.style.display="inline"})},registerButton:function(a,b){j[b]=j[b]||[],j[b].push(a)},registerViewerReview:function(a,b){k[b]=k[b]||[],k[b].push(a)},registerComposer:function(a,b){l[b]=l[b]||[],l[b].push(a)},registerToggle:function(a,b,c,d){m[a]=m[a]||[],m[a].push([b,c,d])},registerStoryDeleteListener:function(a){var c=this;b("Arbiter").subscribe("Story/delete",function(d,e){c._updateToggles(a,!1),new(b("AsyncRequest"))(b("XReviewsTabUpdateHistogramController").getURIBuilder().setInt("page_id",a).getURI()).setMethod("GET").setReadOnly(!0).send()})},addUserReview:function(a,b,c,d,e,f,g,h,i,j,k){this._updateState(!0,a,b,c,d,e,f,g,h,i,j,k)},deleteUserReview:function(a,b,c,d,e,f){this._updateState(!1,a,null,null,null,b,c,d,f,null,null);if(e){a=document.getElementById(e);b=a.parentNode.parentNode;b.parentNode.removeChild(b)}},_updateState:function(a,c,d,e,f,g,m,n,o,p,q,r){__p&&__p();if(p){f=b("ge")("own_review_container");f&&b("DOM").setContent(f,p)}else if(o){f=b("ge")("viewer_own_review_tab");f&&b("DOM").replace(f,o)}else if(a){p=b("ge")("page_reviews_tab_list");p&&b("DOM").prependContent(p,e);f="div._yj3";o=b("DOM").scry(document,f)[0];o&&o.parentNode.removeChild(o)}p=k[c]||[];for(e=0;e<p.length;e++)b("DOM").remove(p[e]);this._updateToggles(c,a);f=l[c]||[];for(e=0;e<f.length;e++){o=f[e];a?o.hide():(o.clear(),o.show())}p=j[c]||[];for(e=0;e<p.length;e++){o=p[e];f=b("DOM").find(o,".uiButtonText");c=b("DOM").find(o,"i");var s;a?(o=i("76766"),s=h._("Reviewed")):(o=i("76771"),s=h._("Review"));var t=b("DOM").create("span");b("ReactDOM").render(b("React").jsx("div",{children:s}),f);b("ReactDOM").render(b("React").jsx(b("Image.react"),{src:o,style:{paddingRight:"5px"}}),t);b("DOM").replace(c,t)}if(a){s=b("DOM").scry(document,"#page_recommendations_browse_list")[0];s&&b("DOM").prependContent(s,d)}if(g){f=b("ge")("page_reviews_pill_and_histogram");f&&b("DOM").replace(f,g)}if(m){o=b("ge")("pages_inline_rating_summary");o&&b("DOM").replace(o,m)}if(n){c=b("ge")("pages_review_needy_place_card");c&&b("DOM").replace(c,n)}if(q){t=b("ge")("spotlight_reviews_card_list");t&&b("DOM").prependContent(t,q)}if(r){p=b("ge")("review_composer_container");b("DOM").insertAfter(p,r)}},registerPhotoUpload:function(a,c){b("Arbiter").subscribe("multi-upload/images-upload-completed/"+c,function(){n[c]=!1}),b("Arbiter").subscribe("multi-upload/images-upload-start/"+c,function(){n[c]=!0}),b("Event").listen(a,"submit",function(){if(n[c]){new(b("Dialog"))().setTitle(h._("Photos Are Uploading")).setSemiModal(!0).setButtons(b("Dialog").OK).setBody(h._("Please wait until photo is uploaded before posting.")).show();return!1}return!0}.bind(this))},_updateToggles:function(a,c){a=m[a]||[];for(var d=0;d<a.length;d++){var e=a[d],f=e[c?1:2];b("DOM").setContent(e[0],f)}}};b("Run").onLeave(function(){j={},k={},l={},m={},n={}});e.exports=a}),null);
__d("PageReviewInlineComposer",["fbt","Arbiter","CSS","Event","Input","ReviewsController","Run"],(function(a,b,c,d,e,f,g){__p&&__p();c=function(){"use strict";__p&&__p();function c(a,c,d,e,f,g,h,i,j,k){j=j.getInstance(),j.subscribe("changed",function(){b("CSS").conditionShow(k,!j.getIsPublicSelected())}),i||f&&b("Event").listen(f,"focus",function(){b("CSS").addClass(f,"expand"),d&&b("CSS").show(d),f.setAttribute("rows",6)}),b("Run").onBeforeUnload(this.$1.bind(this)),h.onClick(function(a,b){a.setAttribute("value",b),f.focus()}.bind(null,e)),this.$2=c,this.$3=h,this.$4=f,this.$5=g,this.$6=e,b("ReviewsController").registerComposer(this,a),b("ReviewsController").registerPhotoUpload(c,g)}var d=c.prototype;d.$1=function(){if(this.$4.offsetParent!==null&&!b("Input").isEmpty(this.$4)&&!(a.Dialog&&a.Dialog.getCurrent()))return g._("You haven't finished your review yet. Do you want to leave without finishing?")};d.hide=function(){b("CSS").hide(this.$2)};d.show=function(){b("CSS").show(this.$2)};d.clear=function(){this.$3.setMyRating(0),this.$4.value="",this.$6.setAttribute("value",null),this.$5!==null&&b("Arbiter").inform("multi-upload/composer-reset/"+this.$5,this,b("Arbiter").BEHAVIOUR_PERSISTENT)};return c}();e.exports=c}),null);